# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Описание базовых классов, их предназначение и функции:
## Слой отображения (View)
### Класс ProductRenderer

Класс `ProductRenderer` отвечает за отображение информации о продукте на веб-странице.

#### Методы:

- `renderProduct(product: Product): HTMLElement`: Метод `renderProduct` принимает объект `product` типа `Product` и возвращает HTML элемент карточки продукта, содержащий информацию о продукте.

#### Описание:

Метод `renderProduct` создает HTML элемент карточки продукта на основе переданного объекта `product`. Для этого он получает шаблон карточки из HTML, заполняет его данными о продукте и возвращает полученный HTML элемент.

##### Параметры:

- `product`: Объект типа `Product`, содержащий информацию о продукте.

##### Возвращаемое значение:

HTML элемент карточки продукта, содержащий информацию о продукте.

##### Примечания:

- Если цена продукта равна `null`, вместо цены выводится текст "Бесценно".
- В зависимости от категории продукта, карточке присваивается соответствующий класс для стилизации.


### Класс Modal

Класс `Modal` отвечает за управление модальными окнами на веб-странице.

#### Свойства:

- `private modalElement: HTMLElement`: HTML элемент модального окна.
- `private basketModal: BasketModal`: Объект класса `BasketModal`, отвечающий за отображение корзины.
- `private orderModal: OrderModal`: Объект класса `OrderModal`, отвечающий за отображение формы заказа.
- `private contactsModal: ContactsModal`: Объект класса `ContactsModal`, отвечающий за отображение контактной информации.
- `private successModal: SuccessModal`: Объект класса `SuccessModal`, отвечающий за отображение сообщения об успешном оформлении заказа.
- `private cardPreviewModal: CardPreviewModal`: Объект класса `CardPreviewModal`, отвечающий за отображение предпросмотра карточки продукта.

#### Методы:

- `constructor()`: Конструктор класса `Modal`, инициализирует объекты модальных окон и устанавливает обработчики событий.
- `private initEventListeners(): void`: Инициализирует обработчики событий для различных элементов на странице.
- `private handleBasketClick(event: MouseEvent): void`: Обработчик клика на кнопку корзины, открывает модальное окно с корзиной.
- `private handleGalleryItemClick(event: MouseEvent): void`: Обработчик клика на карточку продукта в галерее, открывает предпросмотр карточки продукта.
- `private handleBodyClick(event: MouseEvent): void`: Обработчик клика на элементы страницы, управляет отображением модальных окон.
- `private handleOverlayClick(event: MouseEvent): void`: Обработчик клика на оверлей модального окна, закрывает модальное окно.
- `private openModal(): void`: Открывает модальное окно.
- `private closeModal(): void`: Закрывает модальное окно и скрывает все дочерние модальные окна.

#### Описание:

Класс `Modal` управляет отображением различных модальных окон на веб-странице, таких как корзина, форма заказа, контактная информация и сообщение об успешном оформлении заказа. Каждое модальное окно представлено отдельным классом (например, `BasketModal`, `OrderModal` и т. д.), и `Modal` создает экземпляры этих классов для управления отображением их содержимого.

##### Примечания:

- Обработчики событий устанавливаются в конструкторе класса.
- Метод `handleOverlayClick` привязывается к контексту `this` с помощью метода `bind`, чтобы сохранить контекст при вызове обработчика.
- При закрытии модального окна метод `closeModal` скрывает все дочерние модальные окна.


### Класс BasketModal

Класс `BasketModal` отвечает за отображение модального окна корзины.

#### Свойства:

- `private modalElement: HTMLElement`: HTML элемент модального окна, к которому привязана корзина.
- `private basketElement: HTMLElement | null`: HTML элемент корзины.
- `private basketCounterElement: HTMLElement | null`: HTML элемент счетчика товаров в корзине.
- `private basketCounter: number`: Счетчик товаров в корзине.

#### Методы:

- `constructor(modalElement: HTMLElement)`: Конструктор класса `BasketModal`, инициализирует свойства и создает элемент корзины.
- `private createBasket(): void`: Создает HTML элемент корзины и добавляет его к модальному окну.
- `public showBasket(): void`: Отображает корзину.
- `public hideBasket(): void`: Скрывает корзину.
- `public updateBasketPrice(): void`: Обновляет отображение суммы товаров в корзине.
- `public getTotalPrice(): number`: Вычисляет и возвращает общую сумму товаров в корзине.
- `public updateBasketCounter(action: 'increment' | 'decrement'): void`: Обновляет счетчик товаров в корзине в зависимости от действия.
- `public getBasketList(): HTMLElement | null`: Возвращает HTML элемент списка корзины для добавления карточек продуктов.

#### Описание:

Класс `BasketModal` представляет собой модальное окно для отображения содержимого корзины с товарами. При создании экземпляра класса, корзина добавляется к модальному окну, инициализируется счетчик товаров в корзине. Методы класса позволяют отображать и скрывать корзину, обновлять сумму товаров и счетчик в корзине, а также получать элемент списка корзины для добавления в него карточек продуктов.

##### Примечания:

- Корзина скрывается по умолчанию при создании объекта класса.
- Для обновления счетчика товаров в корзине используются методы `updateBasketCounter` и `getTotalPrice`.


### Класс OrderModal

Класс `OrderModal` отвечает за отображение модального окна с формой оформления заказа.

#### Свойства:

- `private modalElement: HTMLElement`: HTML элемент модального окна, к которому привязана форма заказа.
- `private orderTemplate: HTMLTemplateElement`: HTML шаблон для формы заказа.
- `private orderElement: HTMLElement | null`: HTML элемент формы заказа.

#### Методы:

- `constructor(modalElement: HTMLElement)`: Конструктор класса `OrderModal`, инициализирует свойства и получает HTML шаблон для формы заказа.
- `public showOrder(): void`: Отображает форму заказа.
- `public hideOrder(): void`: Скрывает форму заказа.

#### Описание:

Класс `OrderModal` представляет собой модальное окно для отображения формы оформления заказа. При вызове метода `showOrder()`, форма заказа добавляется к модальному окну, а при вызове метода `hideOrder()`, форма заказа скрывается. Для валидации поля ввода адреса используется функция `validateAddressInput`.

##### Примечания:

- Форма заказа добавляется к модальному окну только в случае, если она еще не была создана.
- При скрытии формы заказа, она удаляется из DOM.


### Класс ContactsModal

Класс `ContactsModal` отвечает за отображение модального окна с формой контактных данных покупателя.

#### Свойства:

- `private modalElement: HTMLElement`: HTML элемент модального окна, к которому привязана форма контактных данных.
- `private contactsTemplate: HTMLTemplateElement`: HTML шаблон для формы контактных данных.
- `private contactsElement: HTMLElement | null`: HTML элемент формы контактных данных.

#### Методы:

- `constructor(modalElement: HTMLElement)`: Конструктор класса `ContactsModal`, инициализирует свойства и получает HTML шаблон для формы контактных данных.
- `public showContacts(): void`: Отображает форму контактных данных.
- `public hideContacts(): void`: Скрывает форму контактных данных.
- `private handleInput(): void`: Обработчик события ввода данных в поля формы.
- `private handleSubmit(event: Event): void`: Обработчик события отправки формы.

#### Описание:

Класс `ContactsModal` представляет собой модальное окно для отображения формы с контактными данными покупателя. При вызове метода `showContacts()`, форма добавляется к модальному окну, а при вызове метода `hideContacts()`, форма скрывается. Для валидации полей ввода email и телефона используется функция `validateFormInputs`.

##### Примечания:

- Форма контактных данных добавляется к модальному окну только в случае, если она еще не была создана.
- При скрытии формы контактных данных, она удаляется из DOM.


### Класс SuccessModal

Класс `SuccessModal` отвечает за отображение модального окна с сообщением об успешном оформлении заказа.

#### Свойства:

- `private modalElement: HTMLElement`: HTML элемент модального окна, к которому привязано сообщение об успешном оформлении заказа.
- `private successTemplate: HTMLTemplateElement`: HTML шаблон для сообщения об успешном оформлении заказа.
- `private successElement: HTMLElement | null`: HTML элемент сообщения об успешном оформлении заказа.

#### Методы:

- `constructor(modalElement: HTMLElement)`: Конструктор класса `SuccessModal`, инициализирует свойства и получает HTML шаблон для сообщения об успешном оформлении заказа.
- `public showSuccess(totalPrice: number): void`: Отображает сообщение об успешном оформлении заказа.
- `public hideSuccess(): void`: Скрывает сообщение об успешном оформлении заказа.

#### Описание:

Класс `SuccessModal` представляет собой модальное окно для отображения сообщения об успешном оформлении заказа. При вызове метода `showSuccess()`, сообщение добавляется к модальному окну и отображает сумму списанных синапсов. При вызове метода `hideSuccess()`, сообщение скрывается и удаляется из DOM.

##### Примечания:

- Сообщение об успешном оформлении заказа добавляется к модальному окну только в случае, если оно еще не было создано.
- При скрытии сообщения об успешном оформлении заказа, оно удаляется из DOM.


### Класс CardPreviewModal

Класс `CardPreviewModal` отвечает за отображение модального окна с предпросмотром карточки продукта.

#### Свойства:

- `private modalElement: HTMLElement`: HTML элемент модального окна, к которому привязан предпросмотр карточки продукта.
- `private basketCounter: number`: Счетчик товаров в корзине.
- `private basketModal: BasketModal`: Ссылка на экземпляр корзины.

#### Методы:

- `constructor(modalElement: HTMLElement, basketModal: BasketModal)`: Конструктор класса `CardPreviewModal`, инициализирует свойства.
- `public openCardPreview(product: Product): void`: Отображает предпросмотр карточки продукта.
- `private handleBasketButtonClick(product: Product): void`: Обработчик события клика на кнопку "В корзину".
- `private createBasketItem(product: Product): HTMLElement`: Создает элемент карточки продукта в корзине.
- `private removeBasketItem(item: HTMLElement): void`: Удаляет элемент карточки продукта из корзины.
- `public closeCardPreview(): void`: Закрывает предпросмотр карточки продукта.

#### Описание:

Класс `CardPreviewModal` представляет собой модальное окно с предпросмотром карточки продукта. При вызове метода `openCardPreview()`, предпросмотр карточки продукта отображается, а при клике на кнопку "В корзину" карточка продукта добавляется в корзину. При вызове метода `closeCardPreview()`, предпросмотр карточки продукта закрывается.

##### Примечания:

- При добавлении карточки продукта в корзину, используется экземпляр корзины, чтобы обновить сумму и счетчик товаров в корзине.
- Предпросмотр карточки продукта закрывается при добавлении карточки в корзину или при явном вызове метода `closeCardPreview()`.


## Слой данных (Model)

### Класс ProductApi

Класс `ProductApi` отвечает за взаимодействие с сервером для получения списка продуктов.

#### Методы:

- `async fetchProducts(): Promise<any[]>`: Асинхронно запрашивает список продуктов с сервера.

#### Описание:

Класс `ProductApi` содержит метод `fetchProducts()`, который асинхронно отправляет запрос на сервер для получения списка продуктов. Метод обрабатывает ответ от сервера, проверяет его наличие и корректность формата данных. В случае успешного запроса, метод возвращает массив продуктов, а в случае ошибки возвращает пустой массив и выводит сообщение об ошибке в консоль.

##### Примечания:

- Для отправки запроса на сервер используется переменная `API_URL`, которая должна содержать адрес API.
- В случае успешного получения списка продуктов, данные выводятся в консоль с помощью `console.log()`. Это может быть полезно для отладки.

## Слой коммуникации (Presenter)

### Класс Api

Класс `Api` обеспечивает удобный интерфейс для выполнения HTTP-запросов к внешнему API.

#### Свойства:

- `baseUrl`: string - базовый URL для формирования полного URL запросов.
- `options`: RequestInit - объект с опциями для настройки запросов.

#### Конструктор:

- `constructor(baseUrl: string, options: RequestInit = {})`: Создает новый экземпляр класса `Api` с указанным базовым URL и опциями запроса. По умолчанию опции запроса пусты.

#### Методы:

- `get(uri: string): Promise<object>`: Выполняет GET-запрос по указанному URI и возвращает Promise с объектом ответа от сервера.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>`: Выполняет POST-запрос по указанному URI с переданными данными и методом запроса. Возвращает Promise с ответом от сервера.
- `handleResponse(response: Response): Promise<object>`: Обрабатывает ответ от сервера. Если ответ успешен (код ответа 2xx), возвращает Promise с объектом JSON из тела ответа. В противном случае, возвращает Promise с объектом ошибки, либо с текстом статуса ответа.
- `setBaseUrl(baseUrl: string)`: Устанавливает новый базовый URL для запросов.
- `setOptions(options: RequestInit)`: Устанавливает новые опции для запросов.

Этот класс предоставляет универсальный способ взаимодействия с внешним API путем отправки GET и POST запросов, а также обработки ответов от сервера.

## Основные события в приложении

- **Отображение детальной информации о товаре:** Пользователь нажимает на товар в каталоге для просмотра подробной информации о нем.
- **Добавление товара в корзину:** Пользователь выбирает товар, затем товар добавляется в корзину.
- **Удаление товара из корзины:** Пользователь удаляет выбранный товар из корзины.
- **Оформление заказа:** Пользователь заполняет форму оформления заказа, вводит информацию о доставке, выбирает способ оплаты и подтверждает заказ.
- **Просмотр каталога товаров:** Пользователь просматривает доступные товары в каталоге магазина.
- **Открытие и закрытие модальных окон:** Пользователь взаимодействует с модальными окнами, такими как окно с подтверждением заказа или окно с сообщением об ошибке.
- **Проверка заполнения формы оформления заказа:** При попытке оформления заказа пользователь проходит проверку правильности заполнения формы.
- **Отображение сообщений об успешном оформлении заказа или об ошибках:** Пользователь видит сообщения об успешном оформлении заказа или об ошибках, возникающих в процессе работы приложения.

Эти события представляют основные взаимодействия пользователя с приложением и его функциональностью.